var buttonMenu=document.querySelector(".js-menu-button"),menu=document.querySelector(".header-menu");buttonMenu.addEventListener("click",function(){menu.classList.toggle("header-menu--opened")});var imageContainer=document.querySelector(".module__picture"),image=document.querySelector(".module__image"),imageIndicator=document.querySelector(".module__indicator"),imageScale=document.querySelector(".module__scale strong"),imageBrightness=document.querySelector(".module__light strong"),imageWindow=imageContainer.offsetWidth,imageWidth=image.offsetWidth,imageIndicatorWidth=imageIndicator.offsetWidth,pointerArray=[],distancePrev=0,currentScale=1,currentBrightness=100,prevAngleChange=0;image.style.left="0px",imageIndicator.style.left="0px",image.style.transform="scale("+currentScale+")",imageScale.innerHTML=100*currentScale+"%",imageBrightness.innerHTML=currentBrightness+"%";var moveToStartPosition=function(){imageWindow=imageContainer.offsetWidth,imageWidth=image.offsetWidth,imageIndicatorWidth=imageIndicator.offsetWidth,image.style.left="0px",imageIndicator.style.left="0px",image.style.transform="scale(1)",imageBrightness.innerHTML="100%",imageScale.innerHTML="100%"},getDistance=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},getAngle=function(e,t){return Math.atan2(e.y-t.y,e.x-t.x)},onMove=function(e){var t=pointerArray[e].prevPosition.x,r=event.x,n=r-t,i=1*image.style.left.replace("px",""),a=1*imageIndicator.style.left.replace("px",""),o=(imageWindow-imageIndicatorWidth)/(imageWidth-imageWindow);0<n?i+=Math.abs(n):i-=Math.abs(n),0<n?a-=Math.abs(n)*o:a+=Math.abs(n)*o,0<i&&(a=i=0),i<imageWindow-imageWidth&&(i=imageWindow-imageWidth,a=imageWindow-imageIndicatorWidth),image.style.left=i+"px",pointerArray[e].prevPosition.x=r,imageIndicator.style.left=a+"px"},onPinch=function(){var e=getDistance(pointerArray[0].currentPosition,pointerArray[1].currentPosition),t=getDistance(pointerArray[0].startPosition,pointerArray[1].startPosition);if(!(Math.abs(e-t)<30)){if(distancePrev){distancePrev<e?currentScale+=.03:(currentScale-=.03)<=1&&(currentScale=1),image.style.transform="scale("+currentScale+")",imageScale.innerHTML=Math.ceil(100*currentScale)+"%"}distancePrev=e}},onRotate=function(){var e=getAngle(pointerArray[0].startPosition,pointerArray[1].startPosition),t=getAngle(pointerArray[0].currentPosition,pointerArray[1].currentPosition),r=180*(t-e)/Math.PI;if(prevAngleChange){if(Math.abs(e-t)<.5)return;r<0&&(r+=360),prevAngleChange<r?currentBrightness+=1:currentBrightness-=1,100<currentBrightness&&(currentBrightness=100),currentBrightness<0&&(currentBrightness=0),image.style.filter="brightness("+currentBrightness+"%)",imageBrightness.innerHTML=Math.ceil(currentBrightness)+"%"}prevAngleChange=r};window.addEventListener("resize",function(){moveToStartPosition()}),imageContainer.addEventListener("pointerdown",function(e){imageContainer.setPointerCapture(e.pointerId),pointerArray.push({id:e.pointerId,startPosition:{x:e.x,y:e.y},prevPosition:{x:e.x,y:e.y},currentPosition:{x:e.x,y:e.y}})}),imageContainer.addEventListener("pointermove",function(e){if(0!==pointerArray.length){for(var t=null,r=0;r<pointerArray.length;r++)if(pointerArray[r].id===e.pointerId){t=r;break}pointerArray[t].currentPosition.x=e.x,pointerArray[t].currentPosition.y=e.y,1<pointerArray.length?(onPinch(),onRotate()):onMove(t)}}),imageContainer.addEventListener("pointerup",function(e){for(var t=null,r=0;r<pointerArray.length;r++)pointerArray[r].id===e.pointerId&&(t=r);pointerArray.splice(pointerArray[t],1)}),imageContainer.addEventListener("pointercancel",moveToStartPosition);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlbnNvci5qcyJdLCJuYW1lcyI6WyJidXR0b25NZW51IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibWVudSIsImFkZEV2ZW50TGlzdGVuZXIiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJpbWFnZUNvbnRhaW5lciIsImltYWdlIiwiaW1hZ2VJbmRpY2F0b3IiLCJpbWFnZVNjYWxlIiwiaW1hZ2VCcmlnaHRuZXNzIiwiaW1hZ2VXaW5kb3ciLCJvZmZzZXRXaWR0aCIsImltYWdlV2lkdGgiLCJpbWFnZUluZGljYXRvcldpZHRoIiwicG9pbnRlckFycmF5IiwiZGlzdGFuY2VQcmV2IiwiY3VycmVudFNjYWxlIiwiY3VycmVudEJyaWdodG5lc3MiLCJwcmV2QW5nbGVDaGFuZ2UiLCJzdHlsZSIsImxlZnQiLCJ0cmFuc2Zvcm0iLCJpbm5lckhUTUwiLCJtb3ZlVG9TdGFydFBvc2l0aW9uIiwiZ2V0RGlzdGFuY2UiLCJwMSIsInAyIiwiTWF0aCIsInNxcnQiLCJwb3ciLCJ4IiwieSIsImdldEFuZ2xlIiwiYXRhbjIiLCJvbk1vdmUiLCJpbmRleCIsInN0YXJ0WCIsInByZXZQb3NpdGlvbiIsImV2ZW50IiwiZHgiLCJyZXBsYWNlIiwibGVmdEluZGljYXRvciIsImRsZWZ0IiwiYWJzIiwib25QaW5jaCIsImRpc3RhbmNlIiwiY3VycmVudFBvc2l0aW9uIiwiZGlzdGFuY2VTdGFydCIsInN0YXJ0UG9zaXRpb24iLCJjZWlsIiwib25Sb3RhdGUiLCJzdGFydEFuZ2xlIiwiY3VycmVudEFuZ2xlIiwiYW5nbGVDaGFuZ2UiLCJQSSIsImZpbHRlciIsIndpbmRvdyIsInNldFBvaW50ZXJDYXB0dXJlIiwicG9pbnRlcklkIiwicHVzaCIsImlkIiwibGVuZ3RoIiwiaSIsInNwbGljZSJdLCJtYXBwaW5ncyI6IkFBQUEsSUFBSUEsV0FBYUMsU0FBU0MsY0FBYyxtQkFDcENDLEtBQU9GLFNBQVNDLGNBQWMsZ0JBS2xDRixXQUFXSSxpQkFBaUIsUUFBUyxXQUNuQ0QsS0FB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cEIsRUFBdEJqQixhQUFhK0MsUUFFZmpCLFVBRUFNLFlBSUFoQixPQUFPQyxNQVFYOUIsZUFBZUgsaUJBQWlCLFlBQWEsU0FBVW9DLEdBR3JELElBRkEsSUFBSUgsRUFBUSxLQUVIMkIsRUFBSSxFQUFHQSxFQUFJaEQsYUFBYStDLE9BQVFDLElBQ25DaEQsYUFBYWdELEdBQUdGLEtBQU90QixFQUFNb0IsWUFDL0J2QixFQUFRMkIsR0FJWmhELGFBQWFpRCxPQUFPakQsYUFBYXFCLEdBQVEsS0FNM0M5QixlQUFlSCxpQkFBaUIsZ0JBQWlCcUIiLCJmaWxlIjoic2Vuc29yLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBidXR0b25NZW51ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmpzLW1lbnUtYnV0dG9uJyk7XG52YXIgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXItbWVudScpO1xuXG4vKipcbiAqIEV2ZW50TGlzdGVuZXIgb24gY2xpY2sgbWVudSBidXR0b25cbiAqL1xuYnV0dG9uTWVudS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgbWVudS5jbGFzc0xpc3QudG9nZ2xlKCdoZWFkZXItbWVudS0tb3BlbmVkJyk7XG59KTtcblxudmFyIGltYWdlQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZHVsZV9fcGljdHVyZScpO1xudmFyIGltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZHVsZV9faW1hZ2UnKTtcbnZhciBpbWFnZUluZGljYXRvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2R1bGVfX2luZGljYXRvcicpO1xudmFyIGltYWdlU2NhbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kdWxlX19zY2FsZSBzdHJvbmcnKTtcbnZhciBpbWFnZUJyaWdodG5lc3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kdWxlX19saWdodCBzdHJvbmcnKTtcblxudmFyIGltYWdlV2luZG93ID0gaW1hZ2VDb250YWluZXIub2Zmc2V0V2lkdGg7XG52YXIgaW1hZ2VXaWR0aCA9IGltYWdlLm9mZnNldFdpZHRoO1xudmFyIGltYWdlSW5kaWNhdG9yV2lkdGggPSBpbWFnZUluZGljYXRvci5vZmZzZXRXaWR0aDtcblxudmFyIHBvaW50ZXJBcnJheSA9IFtdO1xudmFyIGRpc3RhbmNlUHJldiA9IDA7XG52YXIgY3VycmVudFNjYWxlID0gMTtcbnZhciBjdXJyZW50QnJpZ2h0bmVzcyA9IDEwMDtcbnZhciBwcmV2QW5nbGVDaGFuZ2UgPSAwO1xuXG5pbWFnZS5zdHlsZS5sZWZ0ID0gJzBweCc7XG5pbWFnZUluZGljYXRvci5zdHlsZS5sZWZ0ID0gJzBweCc7XG5cbmltYWdlLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIgKyBjdXJyZW50U2NhbGUgKyBcIilcIjtcblxuaW1hZ2VTY2FsZS5pbm5lckhUTUwgPSBjdXJyZW50U2NhbGUgKiAxMDAgKyAnJSc7XG5pbWFnZUJyaWdodG5lc3MuaW5uZXJIVE1MID0gY3VycmVudEJyaWdodG5lc3MgKyAnJSc7XG5cbi8qKlxuICogTW92ZXMgc3lzdGVtIHRvIHN0YXJ0IHBvc2l0aW9uXG4gKi9cbnZhciBtb3ZlVG9TdGFydFBvc2l0aW9uID0gZnVuY3Rpb24gKCkge1xuICBpbWFnZVdpbmRvdyA9IGltYWdlQ29udGFpbmVyLm9mZnNldFdpZHRoO1xuICBpbWFnZVdpZHRoID0gaW1hZ2Uub2Zmc2V0V2lkdGg7XG4gIGltYWdlSW5kaWNhdG9yV2lkdGggPSBpbWFnZUluZGljYXRvci5vZmZzZXRXaWR0aDtcblxuICBpbWFnZS5zdHlsZS5sZWZ0ID0gJzBweCc7XG4gIGltYWdlSW5kaWNhdG9yLnN0eWxlLmxlZnQgPSAnMHB4JztcblxuICBpbWFnZS5zdHlsZS50cmFuc2Zvcm0gPSBcInNjYWxlKFwiICsgMSArIFwiKVwiO1xuXG4gIGltYWdlQnJpZ2h0bmVzcy5pbm5lckhUTUwgPSAnMTAwJSc7XG4gIGltYWdlU2NhbGUuaW5uZXJIVE1MID0gJzEwMCUnO1xufTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIGRpc3RhbmNlXG4gKiBAcGFyYW0gcDFcbiAqIEBwYXJhbSBwMlxuICogQHJldHVybnMge251bWJlcn1cbiAqL1xudmFyIGdldERpc3RhbmNlID0gZnVuY3Rpb24gKHAxLCBwMikge1xuICByZXR1cm4gTWF0aC5zcXJ0KE1hdGgucG93KChwMi54IC0gcDEueCksIDIpICsgTWF0aC5wb3coKHAyLnkgLSBwMS55KSwgMikpO1xufTtcblxuLyoqXG4gKiBDYWxjdWxhdGVzIGFuZ2xlXG4gKiBAcGFyYW0gcDFcbiAqIEBwYXJhbSBwMlxuICogQHJldHVybnMge251bWJlcn1cbiAqL1xudmFyIGdldEFuZ2xlID0gZnVuY3Rpb24gKHAxLCBwMikge1xuICByZXR1cm4gTWF0aC5hdGFuMihwMS55IC0gcDIueSwgcDEueCAtIHAyLngpO1xufTtcblxuLyoqXG4gKiBNb3ZlcyBwaWN0dXJlXG4gKiBAcGFyYW0gaW5kZXhcbiAqL1xudmFyIG9uTW92ZSA9IGZ1bmN0aW9uIChpbmRleCkge1xuICB2YXIgc3RhcnRYID0gcG9pbnRlckFycmF5W2luZGV4XS5wcmV2UG9zaXRpb24ueDtcbiAgdmFyIHggPSBldmVudC54O1xuICB2YXIgZHggPSB4IC0gc3RhcnRYO1xuXG4gIHZhciBsZWZ0ID0gaW1hZ2Uuc3R5bGUubGVmdC5yZXBsYWNlKCdweCcsICcnKSAqIDE7XG4gIHZhciBsZWZ0SW5kaWNhdG9yID0gaW1hZ2VJbmRpY2F0b3Iuc3R5bGUubGVmdC5yZXBsYWNlKCdweCcsICcnKSAqIDE7XG5cbiAgdmFyIGRsZWZ0ID0gKGltYWdlV2luZG93IC0gaW1hZ2VJbmRpY2F0b3JXaWR0aCkgLyAoaW1hZ2VXaWR0aCAtIGltYWdlV2luZG93KTtcblxuICBkeCA+IDAgPyBsZWZ0ICs9IE1hdGguYWJzKGR4KSA6IGxlZnQgLT0gTWF0aC5hYnMoZHgpO1xuICBkeCA+IDAgPyBsZWZ0SW5kaWNhdG9yIC09IE1hdGguYWJzKGR4KSAqIGRsZWZ0IDogbGVmdEluZGljYXRvciArPSBNYXRoLmFicyhkeCkgKiBkbGVmdDtcblxuICBpZiAobGVmdCA+IDApIHtcbiAgICBsZWZ0ID0gMDtcbiAgICBsZWZ0SW5kaWNhdG9yID0gMDtcbiAgfVxuXG4gIGlmIChsZWZ0IDwgaW1hZ2VXaW5kb3cgLSBpbWFnZVdpZHRoKSB7XG4gICAgbGVmdCA9IGltYWdlV2luZG93IC0gaW1hZ2VXaWR0aDtcbiAgICBsZWZ0SW5kaWNhdG9yID0gaW1hZ2VXaW5kb3cgLSBpbWFnZUluZGljYXRvcldpZHRoO1xuICB9XG5cbiAgaW1hZ2Uuc3R5bGUubGVmdCA9IGxlZnQgKyAncHgnO1xuICBwb2ludGVyQXJyYXlbaW5kZXhdLnByZXZQb3NpdGlvbi54ID0geDtcblxuICBpbWFnZUluZGljYXRvci5zdHlsZS5sZWZ0ID0gbGVmdEluZGljYXRvciArICdweCc7XG59O1xuXG4vKipcbiAqIFBpbmNoZXMgem9vbVxuICovXG52YXIgb25QaW5jaCA9IGZ1bmN0aW9uICgpIHtcblxuICB2YXIgcGluY2hUcmVzaG9sZCA9IDMwO1xuXG4gIHZhciBkaXN0YW5jZSA9IGdldERpc3RhbmNlKHBvaW50ZXJBcnJheVswXS5jdXJyZW50UG9zaXRpb24sIHBvaW50ZXJBcnJheVsxXS5jdXJyZW50UG9zaXRpb24pO1xuICB2YXIgZGlzdGFuY2VTdGFydCA9IGdldERpc3RhbmNlKHBvaW50ZXJBcnJheVswXS5zdGFydFBvc2l0aW9uLCBwb2ludGVyQXJyYXlbMV0uc3RhcnRQb3NpdGlvbik7XG5cbiAgaWYgKE1hdGguYWJzKGRpc3RhbmNlIC0gZGlzdGFuY2VTdGFydCkgPCBwaW5jaFRyZXNob2xkKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKGRpc3RhbmNlUHJldikge1xuICAgIHZhciBzY2FsZSA9IDAuMDM7XG5cbiAgICBpZiAoZGlzdGFuY2UgPiBkaXN0YW5jZVByZXYpIHtcbiAgICAgIGN1cnJlbnRTY2FsZSArPSBzY2FsZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudFNjYWxlIC09IHNjYWxlO1xuICAgICAgaWYgKGN1cnJlbnRTY2FsZSA8PSAxKSB7XG4gICAgICAgIGN1cnJlbnRTY2FsZSA9IDE7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaW1hZ2Uuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZShcIiArIGN1cnJlbnRTY2FsZSArIFwiKVwiO1xuICAgIGltYWdlU2NhbGUuaW5uZXJIVE1MID0gTWF0aC5jZWlsKGN1cnJlbnRTY2FsZSAqIDEwMCkgKyAnJSc7XG4gIH1cblxuICBkaXN0YW5jZVByZXYgPSBkaXN0YW5jZTtcbn07XG5cbi8qKlxuICogUm90YXRlcyBicmlnaHRuZXNzXG4gKi9cbnZhciBvblJvdGF0ZSA9IGZ1bmN0aW9uICgpIHtcblxuICB2YXIgcm90YXRlVHJlc2hvbGQgPSAwLjU7XG5cbiAgdmFyIHN0YXJ0QW5nbGUgPSBnZXRBbmdsZShwb2ludGVyQXJyYXlbMF0uc3RhcnRQb3NpdGlvbiwgcG9pbnRlckFycmF5WzFdLnN0YXJ0UG9zaXRpb24pO1xuICB2YXIgY3VycmVudEFuZ2xlID0gZ2V0QW5nbGUocG9pbnRlckFycmF5WzBdLmN1cnJlbnRQb3NpdGlvbiwgcG9pbnRlckFycmF5WzFdLmN1cnJlbnRQb3NpdGlvbik7XG4gIHZhciBhbmdsZUNoYW5nZSA9IChjdXJyZW50QW5nbGUgLSBzdGFydEFuZ2xlKSAqIDE4MCAvIE1hdGguUEk7XG5cbiAgaWYgKHByZXZBbmdsZUNoYW5nZSkge1xuICAgIGlmIChNYXRoLmFicyhzdGFydEFuZ2xlIC0gY3VycmVudEFuZ2xlKSA8IHJvdGF0ZVRyZXNob2xkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKGFuZ2xlQ2hhbmdlIDwgMCkge1xuICAgICAgYW5nbGVDaGFuZ2UgKz0gMzYwO1xuICAgIH1cblxuICAgIGlmIChwcmV2QW5nbGVDaGFuZ2UgPCBhbmdsZUNoYW5nZSkge1xuICAgICAgY3VycmVudEJyaWdodG5lc3MgKz0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3VycmVudEJyaWdodG5lc3MgLT0gMTtcbiAgICB9XG5cbiAgICBpZiAoY3VycmVudEJyaWdodG5lc3MgPiAxMDApIHtcbiAgICAgIGN1cnJlbnRCcmlnaHRuZXNzID0gMTAwO1xuICAgIH1cblxuICAgIGlmIChjdXJyZW50QnJpZ2h0bmVzcyA8IDApIHtcbiAgICAgIGN1cnJlbnRCcmlnaHRuZXNzID0gMDtcbiAgICB9XG5cbiAgICBpbWFnZS5zdHlsZS5maWx0ZXIgPSAnYnJpZ2h0bmVzcygnICsgY3VycmVudEJyaWdodG5lc3MgKyAnJSknO1xuICAgIGltYWdlQnJpZ2h0bmVzcy5pbm5lckhUTUwgPSBNYXRoLmNlaWwoY3VycmVudEJyaWdodG5lc3MpICsgJyUnO1xuXG4gIH1cblxuICBwcmV2QW5nbGVDaGFuZ2UgPSBhbmdsZUNoYW5nZTtcblxufTtcblxuLyoqXG4gKiBFdmVudExpc3RlbmVyIG9uIHdpbmRvdyByZXNpemVcbiAqL1xud2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGZ1bmN0aW9uICgpIHtcbiAgbW92ZVRvU3RhcnRQb3NpdGlvbigpO1xufSk7XG5cbi8qKlxuICogRXZlbnRMaXN0ZW5lciBvbiBwb2ludGVyZG93blxuICovXG5pbWFnZUNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuICBpbWFnZUNvbnRhaW5lci5zZXRQb2ludGVyQ2FwdHVyZShldmVudC5wb2ludGVySWQpO1xuXG4gIHBvaW50ZXJBcnJheS5wdXNoKHtcbiAgICBpZDogZXZlbnQucG9pbnRlcklkLFxuICAgIHN0YXJ0UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfSxcbiAgICBwcmV2UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfSxcbiAgICBjdXJyZW50UG9zaXRpb246IHtcbiAgICAgIHg6IGV2ZW50LngsXG4gICAgICB5OiBldmVudC55XG4gICAgfVxuICB9KTtcbn0pO1xuXG4vKipcbiAqIEV2ZW50TGlzdGVuZXIgb24gcG9pbnRlcm1vdmVcbiAqL1xuaW1hZ2VDb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcm1vdmUnLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgaWYgKHBvaW50ZXJBcnJheS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm5cbiAgfVxuXG4gIHZhciBpbmRleCA9IG51bGw7XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcG9pbnRlckFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHBvaW50ZXJBcnJheVtpXS5pZCA9PT0gZXZlbnQucG9pbnRlcklkKSB7XG4gICAgICBpbmRleCA9IGk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICBwb2ludGVyQXJyYXlbaW5kZXhdLmN1cnJlbnRQb3NpdGlvbi54ID0gZXZlbnQueDtcbiAgcG9pbnRlckFycmF5W2luZGV4XS5jdXJyZW50UG9zaXRpb24ueSA9IGV2ZW50Lnk7XG5cbiAgaWYgKHBvaW50ZXJBcnJheS5sZW5ndGggPiAxKSB7XG5cbiAgICBvblBpbmNoKCk7XG5cbiAgICBvblJvdGF0ZSgpO1xuXG4gIH0gZWxzZSB7XG5cbiAgICBvbk1vdmUoaW5kZXgpO1xuXG4gIH1cbn0pO1xuXG4vKipcbiAqIEV2ZW50TGlzdGVuZXIgb24gcG9pbnRlcnVwXG4gKi9cbmltYWdlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ3BvaW50ZXJ1cCcsIGZ1bmN0aW9uIChldmVudCkge1xuICB2YXIgaW5kZXggPSBudWxsO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcG9pbnRlckFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgaWYgKHBvaW50ZXJBcnJheVtpXS5pZCA9PT0gZXZlbnQucG9pbnRlcklkKSB7XG4gICAgICBpbmRleCA9IGk7XG4gICAgfVxuICB9XG5cbiAgcG9pbnRlckFycmF5LnNwbGljZShwb2ludGVyQXJyYXlbaW5kZXhdLCAxKTtcbn0pO1xuXG4vKipcbiAqIEV2ZW50TGlzdGVuZXIgb24gcG9pbnRlcmNhbmNlbFxuICovXG5pbWFnZUNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdwb2ludGVyY2FuY2VsJywgbW92ZVRvU3RhcnRQb3NpdGlvbik7XG5cbiJdfQ==
